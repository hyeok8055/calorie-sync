import{r as t,w as q,s as d,ac as G,v as J,y as Q,c as V,ad as _,p as ee,n as te,j as e,R as ne,k as ie}from"./main-CaSg3MKk.js";import{u as le}from"./useFood-CW_uQqY-.js";import{L as k}from"./index-D0SV6dX_.js";import{T as N}from"./index-C-U6eI8X.js";import{B as re}from"./button-C80fxAxj.js";import"./Pagination-Bl5Cn_Ms.js";import"./row-4rXelgiC.js";function se(i){return t.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},i,{style:Object.assign({verticalAlign:"-0.125em"},i.style),className:["antd-mobile-icon",i.className].filter(Boolean).join(" ")}),t.createElement("g",{id:"CheckCircleFill-CheckCircleFill",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("g",{id:"CheckCircleFill-编组"},t.createElement("rect",{id:"CheckCircleFill-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),t.createElement("path",{d:"M24,2 C36.1502645,2 46,11.8497355 46,24 C46,36.1502645 36.1502645,46 24,46 C11.8497355,46 2,36.1502645 2,24 C2,11.8497355 11.8497355,2 24,2 Z M35.8202936,17 L32.7086692,17 C32.6025922,17 32.500859,17.0421352 32.4258461,17.1171378 L32.4258461,17.1171378 L21.3922352,28.1492247 L16.3591562,23.1163755 C16.2841422,23.0413649 16.1824034,22.9992247 16.0763199,22.9992247 L16.0763199,22.9992247 L12.9653996,22.9992247 C12.859342,22.9992247 12.7576259,23.0413445 12.6826161,23.1163228 C12.5263737,23.2724998 12.5263207,23.5257658 12.6824977,23.6820082 C12.8583452,23.8579294 13.0341927,24.0338505 13.2100402,24.2097716 C13.2577488,24.2575002 13.3065097,24.3063074 13.3562592,24.3561283 L13.6661084,24.6666997 C14.3074913,25.3100963 15.0728595,26.0807873 15.8520136,26.8666654 L16.4372421,27.4571699 C18.2552812,29.2922548 19.9983838,31.0574343 20.2666114,31.3285298 L20.301004,31.3632341 C20.8867904,31.9490205 21.8365379,31.9490205 22.4223243,31.3632341 L22.4223243,31.3632341 L36.1031319,17.6828471 C36.1781492,17.6078322 36.2202936,17.5060887 36.2202936,17.4 C36.2202936,17.1790861 36.0412075,17 35.8202936,17 L35.8202936,17 Z",id:"CheckCircleFill-形状结合",fill:"currentColor",fillRule:"nonzero"}))))}function oe(i){return t.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},i,{style:Object.assign({verticalAlign:"-0.125em"},i.style),className:["antd-mobile-icon",i.className].filter(Boolean).join(" ")}),t.createElement("g",{id:"ClockCircleFill-ClockCircleFill",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("g",{id:"ClockCircleFill-编组"},t.createElement("rect",{id:"ClockCircleFill-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),t.createElement("path",{d:"M24,2 C36.1502645,2 46,11.8497355 46,24 C46,36.1502645 36.1502645,46 24,46 C11.8497355,46 2,36.1502645 2,24 C2,11.8497355 11.8497355,2 24,2 Z M24.6,14 L22.4,14 C22.1790861,14 22,14.1790861 22,14.4 L22,14.4 L22,23.1715729 L22.0065089,23.3850222 C22.0584325,24.2354066 22.4192395,25.0405598 23.0251263,25.6464466 L23.0251263,25.6464466 L31.1564971,33.7778175 C31.3127068,33.9340272 31.5659728,33.9340272 31.7221825,33.7778175 L31.7221825,33.7778175 L33.2778175,32.2221825 C33.4340272,32.0659728 33.4340272,31.8127068 33.2778175,31.6564971 L33.2778175,31.6564971 L25.1464466,23.5251263 L25.0952092,23.4650801 C25.0337142,23.38027 25,23.2776595 25,23.1715729 L25,23.1715729 L25,14.4 C25,14.1790861 24.8209139,14 24.6,14 L24.6,14 Z",id:"ClockCircleFill-形状结合",fill:"currentColor",fillRule:"nonzero"}))))}function ae(i){return t.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},i,{style:Object.assign({verticalAlign:"-0.125em"},i.style),className:["antd-mobile-icon",i.className].filter(Boolean).join(" ")}),t.createElement("g",{id:"ExclamationCircleFill-ExclamationCircleFill",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("g",null,t.createElement("rect",{id:"ExclamationCircleFill-矩形",fill:"#D76060",opacity:0,x:0,y:0,width:48,height:48}),t.createElement("path",{d:"M24,2 C36.1502645,2 46,11.8497355 46,24 C46,36.1502645 36.1502645,46 24,46 C11.8497355,46 2,36.1502645 2,24 C2,11.8497355 11.8497355,2 24,2 Z M25.1,31 L22.9,31 C22.6790861,31 22.5,31.1790861 22.5,31.4 L22.5,31.4 L22.5,33.6 C22.5,33.8209139 22.6790861,34 22.9,34 L22.9,34 L25.1,34 C25.3209139,34 25.5,33.8209139 25.5,33.6 L25.5,33.6 L25.5,31.4 C25.5,31.1790861 25.3209139,31 25.1,31 L25.1,31 Z M25.1,14 L22.9,14 C22.6790861,14 22.5,14.1790861 22.5,14.4 L22.5,14.4 L22.5,27.6 C22.5,27.8209139 22.6790861,28 22.9,28 L22.9,28 L25.1,28 C25.3209139,28 25.5,27.8209139 25.5,27.6 L25.5,27.6 L25.5,14.4 C25.5,14.1790861 25.3209139,14 25.1,14 L25.1,14 Z",id:"ExclamationCircleFill-形状结合",fill:"currentColor",fillRule:"nonzero"}))))}function ce(i){return t.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},i,{style:Object.assign({verticalAlign:"-0.125em"},i.style),className:["antd-mobile-icon",i.className].filter(Boolean).join(" ")}),t.createElement("g",{id:"InformationCircleFill-InformationCircleFill",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd"},t.createElement("g",{id:"InformationCircleFill-编组"},t.createElement("rect",{id:"InformationCircleFill-矩形",fill:"#FFFFFF",opacity:0,x:0,y:0,width:48,height:48}),t.createElement("path",{d:"M24,2 C36.1502645,2 46,11.8497355 46,24 C46,36.1502645 36.1502645,46 24,46 C11.8497355,46 2,36.1502645 2,24 C2,11.8497355 11.8497355,2 24,2 Z M25.6,20 L21.4,20 C21.1790861,20 21,20.1790861 21,20.4 L21,20.4 L21,22.6 C21,22.8209139 21.1790861,23 21.4,23 L21.4,23 L22.6,23 C22.8209139,23 23,23.1790861 23,23.4 L23,23.4 L23,34.6 C23,34.8209139 23.1790861,35 23.4,35 L23.4,35 L25.6,35 C25.8209139,35 26,34.8209139 26,34.6 L26,34.6 L26,20.4 C26,20.1790861 25.8209139,20 25.6,20 L25.6,20 Z M25.6,14 L23.4,14 C23.1790861,14 23,14.1790861 23,14.4 L23,14.4 L23,16.6 C23,16.8209139 23.1790861,17 23.4,17 L23.4,17 L25.6,17 C25.8209139,17 26,16.8209139 26,16.6 L26,16.6 L26,14.4 C26,14.1790861 25.8209139,14 25.6,14 L25.6,14 Z",id:"InformationCircleFill-形状结合",fill:"currentColor",fillRule:"nonzero"}))))}const de=i=>{const{result:m={}}=q(),{successIcon:a=d.createElement(se,null),errorIcon:g=d.createElement(G,null),infoIcon:p=d.createElement(ce,null),waitingIcon:f=d.createElement(oe,null),warningIcon:h=d.createElement(ae,null)}=m||{};switch(i){case"success":return a;case"error":return g;case"info":return p;case"waiting":return f;case"warning":return h;default:return null}},C="adm-result",me={status:"info"},ue=i=>{const m=J(me,i),{status:a,title:g,description:p,icon:f}=m,h=de(a);return a?Q(m,d.createElement("div",{className:V(C,`${C}-${a}`)},d.createElement("div",{className:`${C}-icon`},f||h),d.createElement("div",{className:`${C}-title`},g),!!p&&d.createElement("div",{className:`${C}-description`},p))):null},{Text:o}=ie,we=()=>{const[i,m]=t.useState(!1),[a,g]=t.useState(""),[p,f]=t.useState(null),h=_(),b=ee(),[u,S]=t.useState([]);te(n=>n.auth.user?.uid);const{saveFoodData:D,fetchFoodDetails:L}=le(),[F,I]=t.useState([]),[j,R]=t.useState(""),[y,B]=t.useState(!1),[P,z]=t.useState(3),[w,E]=t.useState({});t.useEffect(()=>{const n=new URLSearchParams(h.search),r=n.get("items"),s=n.get("type");if(r){const l=r.split(",");S(l);const c={};l.forEach(x=>{c[x]=1}),E(c)}s&&R(s)},[h.search]),t.useEffect(()=>{(async()=>{if(u.length>0){const r=await L(u);I(r)}})()},[u,L]);const v=n=>{if(!n)return 100;const r=n.match(/\d+/);return r?Number(r[0]):100},T=n=>n.reduce((r,s)=>{const l=w[s.name]||1,c=s&&s.calories&&!isNaN(Number(s.calories))?Number(s.calories):0;return r+c*l},0),W=async()=>{m(!0);try{const n=T(F),r=Math.abs(n-parseInt(a,10)||0);f(r);const s=F.map(l=>{const c=v(l.weight),x=w[l.name]||1,Z=l.calories&&!isNaN(Number(l.calories))?Number(l.calories):0,O=l.nutrients?.carbs&&!isNaN(Number(l.nutrients.carbs))?Number(l.nutrients.carbs):0,$=l.nutrients?.fat&&!isNaN(Number(l.nutrients.fat))?Number(l.nutrients.fat):0,X=l.nutrients?.protein&&!isNaN(Number(l.nutrients.protein))?Number(l.nutrients.protein):0,H=Z*x,K=O*x,U=$*x,Y=X*x;return{name:l.name||"",calories:H,weight:c,portion:x,nutrients:{carbs:K,fat:U,protein:Y}}});await D(j,s,Number(a),n,u,j!=="snacks"?1:0),B(!0),m(!1)}catch(n){console.error("저장 실패:",n),m(!1)}};t.useEffect(()=>{if(y){const n=setInterval(()=>{z(s=>s-1)},1e3),r=setTimeout(()=>{b("/")},3e3);return()=>{clearInterval(n),clearTimeout(r)}}},[y,b]);const M=n=>{g(n)},A=(n,r)=>{E(s=>({...s,[n]:r}))};return e.jsx("div",{style:{minHeight:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"center",overflow:"auto",paddingBottom:"20px"},children:i&&!y?e.jsxs("div",{style:{marginTop:"60%",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(ne,{style:{fontSize:48,color:"#5FDD9D"},spin:!0}),e.jsx(o,{style:{marginTop:15,color:"#666",fontFamily:"Pretendard-500"},children:"기록 중입니다..."})]}):y?e.jsxs("div",{style:{width:"80%",maxWidth:"300px",marginTop:"40%",textAlign:"center"},children:[e.jsx(ue,{status:"success",title:e.jsx(o,{style:{fontSize:"24px",fontWeight:"700",color:"#5FDD9D",fontFamily:"Pretendard-700"},children:"기록 완료"}),description:e.jsx(o,{style:{fontSize:"16px",color:"#666",fontFamily:"Pretendard-500"},children:"기록이 정상적으로 완료되었습니다."})}),e.jsx("div",{style:{textAlign:"center",marginTop:15},children:e.jsxs(o,{style:{fontSize:"16px",color:"#888",fontFamily:"Pretendard-500"},children:[P,"초 뒤에 메인 페이지로 돌아갑니다."]})})]}):e.jsxs("div",{style:{width:"100%",height:"auto",display:"flex",flexDirection:"column",alignItems:"center",paddingBottom:"30px"},children:[e.jsxs("div",{style:{marginTop:30,marginBottom:30,textAlign:"center"},children:[e.jsx(o,{style:{fontSize:"28px",color:"#5FDD9D",fontFamily:"Pretendard-800",letterSpacing:"1.5px",display:"block",marginBottom:"12px"},children:"예상 칼로리 추측하기"}),e.jsx(o,{style:{fontSize:"19px",color:"#666",fontFamily:"Pretendard-600"},children:"선택한 식사의 예상되는 칼로리를 추정해보세요"})]}),e.jsxs("div",{style:{width:"90%",backgroundColor:"white",borderRadius:"15px",padding:"15px",boxShadow:"0 4px 8px rgba(0,0,0,0.08)",marginBottom:"25px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"15px"},children:[e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#5FDD9D",display:"flex",justifyContent:"center",alignItems:"center",marginRight:"10px"},children:e.jsx(o,{style:{color:"white",fontWeight:"800",fontSize:"15px"},children:"1"})}),e.jsxs(o,{style:{fontSize:"18px",fontWeight:"700",fontFamily:"Pretendard-700"},children:["선택된 메뉴 (",u.length,"개)"]})]}),e.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",backgroundColor:"#f9f9f9",borderRadius:"10px",padding:"10px"},children:e.jsx(k,{dataSource:u,renderItem:n=>{const r=F.find(c=>c.name===n),s=w[n]||1,l=r?`${v(r.weight)*s}g`:"---g";return e.jsxs(k.Item,{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",borderRadius:"8px",backgroundColor:"white",marginBottom:"8px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)"},children:[e.jsxs(o,{style:{fontSize:"16px",fontWeight:"600",fontFamily:"Pretendard-600"},children:[n," ",e.jsxs("span",{style:{fontSize:"12px",fontWeight:"400",fontFamily:"Pretendard-400"},children:["(",s,"인분 당 ",l,")"]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx(N,{min:.5,step:.5,value:w[n]||1,onChange:c=>A(n,c),style:{width:"65px",borderRadius:"6px",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"}}),e.jsx(o,{style:{marginLeft:"5px",fontSize:"14px"},children:"인분"})]})]})}})})]}),e.jsxs("div",{style:{width:"90%",backgroundColor:"white",borderRadius:"15px",padding:"15px",boxShadow:"0 4px 8px rgba(0,0,0,0.08)",marginBottom:"25px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"15px"},children:[e.jsx("div",{style:{width:"24px",height:"24px",borderRadius:"50%",backgroundColor:"#5FDD9D",display:"flex",justifyContent:"center",alignItems:"center",marginRight:"10px"},children:e.jsx(o,{style:{color:"white",fontWeight:"800",fontSize:"15px"},children:"2"})}),e.jsx(o,{style:{fontSize:"18px",fontWeight:"700",fontFamily:"Pretendard-700"},children:"총 칼로리는?"})]}),e.jsxs(o,{style:{fontSize:"16px",color:"#666",fontFamily:"Pretendard-500",marginBottom:"15px",display:"block"},children:["위 ",e.jsxs(o,{style:{fontSize:"17px",fontWeight:"700",fontFamily:"Pretendard-700"},children:[u.length,"가지"]})," 음식의 총 칼로리는 몇 Kcal일까요?"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(N,{placeholder:"예상 칼로리 입력",suffix:"Kcal",value:a,onChange:M,disabled:i,style:{width:"100%",height:"50px",fontSize:"18px",fontFamily:"Pretendard-600",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)",marginBottom:"10px",textAlign:"center"}}),e.jsx(o,{style:{fontSize:"14px",color:"#888",textAlign:"center"},children:"정확한 값을 모르더라도 최대한 가깝게 추정해보세요"})]})]}),e.jsx(re,{style:{height:"55px",width:"90%",backgroundColor:a?"#5FDD9D":"#e0e0e0",color:a?"white":"#999",borderRadius:"10px",boxShadow:a?"0 4px 8px rgba(95, 221, 157, 0.3)":"none",marginTop:"20px",marginBottom:"5%",border:"none",transition:"all 0.3s ease"},onClick:W,disabled:i||!a,children:e.jsx(o,{style:{color:a?"white":"#999",fontSize:"19px",fontWeight:"700",fontFamily:"Pretendard-700"},children:"응답 제출하기"})})]})})};export{we as default};
