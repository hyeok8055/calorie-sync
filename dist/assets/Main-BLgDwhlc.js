import{r,I as N,_ as O,a as ie,u as Y,b as le,c as Z,d as K,K as X,g as re,m as se,e as A,f as ce,h as oe,T as de,C as ue,D as he,i as fe,R as ge,M as q,j as n,k as ee,l as me,n as _,o as xe,p as pe,S as be}from"./main-CAaAWYAx.js";import{R as ye,a as ve}from"./ko-fJ7Ua29R.js";import{u as Ce,s as U,a as G}from"./useFood-MpMYmfXF.js";import{g as Se,u as we}from"./api-CHxLwRf-.js";import{C as J}from"./index-B0lXaUf5.js";import{R as P,C as D}from"./row-ZGTsWOQ9.js";import{W as ke,B as je}from"./button-C3qT-jyL.js";import"./dayjs.min-C8g0wliz.js";import"./Skeleton-CuImxf9e.js";import"./EllipsisOutlined-Ct4_0YAk.js";import"./PlusOutlined-CBbBXk1z.js";var $e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},Ie=function(t,a){return r.createElement(N,O({},t,{ref:a,icon:$e}))},Me=r.forwardRef(Ie),ze={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"},Te=function(t,a){return r.createElement(N,O({},t,{ref:a,icon:ze}))},Fe=r.forwardRef(Te),Re={icon:function(t,a){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:t}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z",fill:a}},{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z",fill:t}}]}},name:"check-circle",theme:"twotone"},De=function(t,a){return r.createElement(N,O({},t,{ref:a,icon:Re}))},Ee=r.forwardRef(De),Ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M834.1 469.2A347.49 347.49 0 00751.2 354l-29.1-26.7a8.09 8.09 0 00-13 3.3l-13 37.3c-8.1 23.4-23 47.3-44.1 70.8-1.4 1.5-3 1.9-4.1 2-1.1.1-2.8-.1-4.3-1.5-1.4-1.2-2.1-3-2-4.8 3.7-60.2-14.3-128.1-53.7-202C555.3 171 510 123.1 453.4 89.7l-41.3-24.3c-5.4-3.2-12.3 1-12 7.3l2.2 48c1.5 32.8-2.3 61.8-11.3 85.9-11 29.5-26.8 56.9-47 81.5a295.64 295.64 0 01-47.5 46.1 352.6 352.6 0 00-100.3 121.5A347.75 347.75 0 00160 610c0 47.2 9.3 92.9 27.7 136a349.4 349.4 0 0075.5 110.9c32.4 32 70 57.2 111.9 74.7C418.5 949.8 464.5 959 512 959s93.5-9.2 136.9-27.3A348.6 348.6 0 00760.8 857c32.4-32 57.8-69.4 75.5-110.9a344.2 344.2 0 0027.7-136c0-48.8-10-96.2-29.9-140.9zM713 808.5c-53.7 53.2-125 82.4-201 82.4s-147.3-29.2-201-82.4c-53.5-53.1-83-123.5-83-198.4 0-43.5 9.8-85.2 29.1-124 18.8-37.9 46.8-71.8 80.8-97.9a349.6 349.6 0 0058.6-56.8c25-30.5 44.6-64.5 58.2-101a240 240 0 0012.1-46.5c24.1 22.2 44.3 49 61.2 80.4 33.4 62.6 48.8 118.3 45.8 165.7a74.01 74.01 0 0024.4 59.8 73.36 73.36 0 0053.4 18.8c19.7-1 37.8-9.7 51-24.4 13.3-14.9 24.8-30.1 34.4-45.6 14 17.9 25.7 37.4 35 58.4 15.9 35.8 24 73.9 24 113.1 0 74.9-29.5 145.4-83 198.4z"}}]},name:"fire",theme:"outlined"},Oe=function(t,a){return r.createElement(N,O({},t,{ref:a,icon:Ae}))},W=r.forwardRef(Oe),He={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},Pe=function(t,a){return r.createElement(N,O({},t,{ref:a,icon:He}))},Q=r.forwardRef(Pe),Ne={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"},Le=function(t,a){return r.createElement(N,O({},t,{ref:a,icon:Ne}))},Ve=r.forwardRef(Le),qe=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],ne=r.forwardRef(function(e,t){var a,i=e.prefixCls,f=i===void 0?"rc-switch":i,m=e.className,S=e.checked,o=e.defaultChecked,s=e.disabled,c=e.loadingIcon,w=e.checkedChildren,j=e.unCheckedChildren,T=e.onClick,F=e.onChange,h=e.onKeyDown,u=ie(e,qe),l=Y(!1,{value:S,defaultValue:o}),b=le(l,2),y=b[0],g=b[1];function x(C,M){var R=y;return s||(R=C,g(R),F?.(R,M)),R}function k(C){C.which===X.LEFT?x(!1,C):C.which===X.RIGHT&&x(!0,C),h?.(C)}function v(C){var M=x(!y,C);T?.(M,C)}var I=Z(f,m,(a={},K(a,"".concat(f,"-checked"),y),K(a,"".concat(f,"-disabled"),s),a));return r.createElement("button",O({},u,{type:"button",role:"switch","aria-checked":y,disabled:s,className:I,ref:t,onKeyDown:k,onClick:v}),c,r.createElement("span",{className:"".concat(f,"-inner")},r.createElement("span",{className:"".concat(f,"-inner-checked")},w),r.createElement("span",{className:"".concat(f,"-inner-unchecked")},j)))});ne.displayName="Switch";const We=e=>{const{componentCls:t,trackHeightSM:a,trackPadding:i,trackMinWidthSM:f,innerMinMarginSM:m,innerMaxMarginSM:S,handleSizeSM:o,calc:s}=e,c=`${t}-inner`,w=A(s(o).add(s(i).mul(2)).equal()),j=A(s(S).mul(2).equal());return{[t]:{[`&${t}-small`]:{minWidth:f,height:a,lineHeight:A(a),[`${t}-inner`]:{paddingInlineStart:S,paddingInlineEnd:m,[`${c}-checked, ${c}-unchecked`]:{minHeight:a},[`${c}-checked`]:{marginInlineStart:`calc(-100% + ${w} - ${j})`,marginInlineEnd:`calc(100% - ${w} + ${j})`},[`${c}-unchecked`]:{marginTop:s(a).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${t}-handle`]:{width:o,height:o},[`${t}-loading-icon`]:{top:s(s(o).sub(e.switchLoadingIconSize)).div(2).equal(),fontSize:e.switchLoadingIconSize},[`&${t}-checked`]:{[`${t}-inner`]:{paddingInlineStart:m,paddingInlineEnd:S,[`${c}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${c}-unchecked`]:{marginInlineStart:`calc(100% - ${w} + ${j})`,marginInlineEnd:`calc(-100% + ${w} - ${j})`}},[`${t}-handle`]:{insetInlineStart:`calc(100% - ${A(s(o).add(i).equal())})`}},[`&:not(${t}-disabled):active`]:{[`&:not(${t}-checked) ${c}`]:{[`${c}-unchecked`]:{marginInlineStart:s(e.marginXXS).div(2).equal(),marginInlineEnd:s(e.marginXXS).mul(-1).div(2).equal()}},[`&${t}-checked ${c}`]:{[`${c}-checked`]:{marginInlineStart:s(e.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:s(e.marginXXS).div(2).equal()}}}}}}},Be=e=>{const{componentCls:t,handleSize:a,calc:i}=e;return{[t]:{[`${t}-loading-icon${e.iconCls}`]:{position:"relative",top:i(i(a).sub(e.fontSize)).div(2).equal(),color:e.switchLoadingIconColor,verticalAlign:"top"},[`&${t}-checked ${t}-loading-icon`]:{color:e.switchColor}}}},Ke=e=>{const{componentCls:t,trackPadding:a,handleBg:i,handleShadow:f,handleSize:m,calc:S}=e,o=`${t}-handle`;return{[t]:{[o]:{position:"absolute",top:a,insetInlineStart:a,width:m,height:m,transition:`all ${e.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:i,borderRadius:S(m).div(2).equal(),boxShadow:f,transition:`all ${e.switchDuration} ease-in-out`,content:'""'}},[`&${t}-checked ${o}`]:{insetInlineStart:`calc(100% - ${A(S(m).add(a).equal())})`},[`&:not(${t}-disabled):active`]:{[`${o}::before`]:{insetInlineEnd:e.switchHandleActiveInset,insetInlineStart:0},[`&${t}-checked ${o}::before`]:{insetInlineEnd:0,insetInlineStart:e.switchHandleActiveInset}}}}},Xe=e=>{const{componentCls:t,trackHeight:a,trackPadding:i,innerMinMargin:f,innerMaxMargin:m,handleSize:S,calc:o}=e,s=`${t}-inner`,c=A(o(S).add(o(i).mul(2)).equal()),w=A(o(m).mul(2).equal());return{[t]:{[s]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:m,paddingInlineEnd:f,transition:`padding-inline-start ${e.switchDuration} ease-in-out, padding-inline-end ${e.switchDuration} ease-in-out`,[`${s}-checked, ${s}-unchecked`]:{display:"block",color:e.colorTextLightSolid,fontSize:e.fontSizeSM,transition:`margin-inline-start ${e.switchDuration} ease-in-out, margin-inline-end ${e.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:a},[`${s}-checked`]:{marginInlineStart:`calc(-100% + ${c} - ${w})`,marginInlineEnd:`calc(100% - ${c} + ${w})`},[`${s}-unchecked`]:{marginTop:o(a).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${t}-checked ${s}`]:{paddingInlineStart:f,paddingInlineEnd:m,[`${s}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${s}-unchecked`]:{marginInlineStart:`calc(100% - ${c} + ${w})`,marginInlineEnd:`calc(-100% + ${c} - ${w})`}},[`&:not(${t}-disabled):active`]:{[`&:not(${t}-checked) ${s}`]:{[`${s}-unchecked`]:{marginInlineStart:o(i).mul(2).equal(),marginInlineEnd:o(i).mul(-1).mul(2).equal()}},[`&${t}-checked ${s}`]:{[`${s}-checked`]:{marginInlineStart:o(i).mul(-1).mul(2).equal(),marginInlineEnd:o(i).mul(2).equal()}}}}}},_e=e=>{const{componentCls:t,trackHeight:a,trackMinWidth:i}=e;return{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},ce(e)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:i,height:a,lineHeight:A(a),verticalAlign:"middle",background:e.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${e.motionDurationMid}`,userSelect:"none",[`&:hover:not(${t}-disabled)`]:{background:e.colorTextTertiary}}),oe(e)),{[`&${t}-checked`]:{background:e.switchColor,[`&:hover:not(${t}-disabled)`]:{background:e.colorPrimaryHover}},[`&${t}-loading, &${t}-disabled`]:{cursor:"not-allowed",opacity:e.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${t}-rtl`]:{direction:"rtl"}})}},Ue=e=>{const{fontSize:t,lineHeight:a,controlHeight:i,colorWhite:f}=e,m=t*a,S=i/2,o=2,s=m-o*2,c=S-o*2;return{trackHeight:m,trackHeightSM:S,trackMinWidth:s*2+o*4,trackMinWidthSM:c*2+o*2,trackPadding:o,handleBg:f,handleSize:s,handleSizeSM:c,handleShadow:`0 2px 4px 0 ${new de("#00230b").setAlpha(.2).toRgbString()}`,innerMinMargin:s/2,innerMaxMargin:s+o+o*2,innerMinMarginSM:c/2,innerMaxMarginSM:c+o+o*2}},Ge=re("Switch",e=>{const t=se(e,{switchDuration:e.motionDurationMid,switchColor:e.colorPrimary,switchDisabledOpacity:e.opacityLoading,switchLoadingIconSize:e.calc(e.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${e.opacityLoading})`,switchHandleActiveInset:"-30%"});return[_e(t),Xe(t),Ke(t),Be(t),We(t)]},Ue);var Je=function(e,t){var a={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(a[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,i=Object.getOwnPropertySymbols(e);f<i.length;f++)t.indexOf(i[f])<0&&Object.prototype.propertyIsEnumerable.call(e,i[f])&&(a[i[f]]=e[i[f]]);return a};const Qe=r.forwardRef((e,t)=>{const{prefixCls:a,size:i,disabled:f,loading:m,className:S,rootClassName:o,style:s,checked:c,value:w,defaultChecked:j,defaultValue:T,onChange:F}=e,h=Je(e,["prefixCls","size","disabled","loading","className","rootClassName","style","checked","value","defaultChecked","defaultValue","onChange"]),[u,l]=Y(!1,{value:c??w,defaultValue:j??T}),{getPrefixCls:b,direction:y,switch:g}=r.useContext(ue),x=r.useContext(he),k=(f??x)||m,v=b("switch",a),I=r.createElement("div",{className:`${v}-handle`},m&&r.createElement(ge,{className:`${v}-loading-icon`})),[C,M,R]=Ge(v),H=fe(i),L=Z(g?.className,{[`${v}-small`]:H==="small",[`${v}-loading`]:m,[`${v}-rtl`]:y==="rtl"},S,o,M,R),d=Object.assign(Object.assign({},g?.style),s),$=function(){l(arguments.length<=0?void 0:arguments[0]),F?.apply(void 0,arguments)};return C(r.createElement(ke,{component:"Switch"},r.createElement(ne,Object.assign({},h,{checked:u,onChange:$,prefixCls:v,className:L,style:d,disabled:k,ref:t,loadingIcon:I}))))}),te=Qe;te.__ANT_SWITCH=!0;const{Text:E}=ee,Ye=(e,t=!1)=>{const[a,i]=r.useState({breakfast:!1,lunch:!1,dinner:!1});r.useEffect(()=>{const u=`meal_viewed_${new Date().toISOString().split("T")[0]}`,l=localStorage.getItem(u);if(l)try{i(JSON.parse(l))}catch(b){console.error("조회 상태 로드 실패:",b)}},[]);const f=r.useCallback(h=>{const l=`meal_viewed_${new Date().toISOString().split("T")[0]}`,b={...a,[h]:!0};i(b),localStorage.setItem(l,JSON.stringify(b))},[a]),m=r.useCallback(h=>{if(!e||!e[h])return null;const u=e[h],l=u.originalCalories?.estimated,b=u.originalCalories?.actual;return b===null||l===null||b===void 0||l===void 0?null:u.calorieDeviation?.applied!==void 0&&u.calorieDeviation?.applied!==null?u.calorieDeviation.applied:b-l},[e]),S=r.useCallback(h=>{if(!e||!e[h])return null;const u=e[h],l=u.originalCalories?.estimated,b=u.originalCalories?.actual;return b===null||l===null||b===void 0||l===void 0?null:b-l},[e]),o=r.useCallback(h=>!e||!e[h]?null:e[h].calorieDeviation?.applied||0,[e]),s=o,c=r.useCallback((h,u=!1)=>{const l=m(h);if(l===null){q.alert({title:"데이터 없음",content:"해당 식사의 칼로리 데이터가 없습니다.",confirmText:"확인"});return}const y=e[h].originalCalories?.actual,g=l;let x="accurate",k="",v="#888",I="#f8f8f8",C="#888";const M=.2*y;g>=-M&&g<=M?(x="accurate",k="완벽해요! 예측과 거의 일치합니다",v="#888",I="#f8f8f8",C="#888"):g<-M?(x="less",k=n.jsxs("span",{children:["실제 섭취량이 예상보다 ",n.jsxs("span",{style:{color:"#ff4d4f"},children:["-",Math.abs(g).toFixed(0),"kcal"]})," 적네요."]}),v="#333",I="rgba(255, 77, 79, 0.08)",C="#ff4d4f"):(x="more",k=n.jsxs("span",{children:["실제 섭취량이 예상보다 ",n.jsxs("span",{style:{color:"#1677ff"},children:["+",g.toFixed(0),"kcal"]})," 많네요."]}),v="#333",I="rgba(22, 119, 255, 0.08)",C="#1677ff");const R=Math.abs(l).toFixed(0),H=l>0;let L=n.jsx(n.Fragment,{children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100%",marginTop:"15px"},children:[n.jsx(E,{style:{fontSize:"18px",textAlign:"center",marginBottom:"15px",color:v,fontWeight:"600"},children:k}),n.jsx("div",{style:{backgroundColor:I,borderRadius:"10px",padding:"15px 20px",width:"90%",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:x!=="accurate"?`0 2px 8px ${C}20`:"none"},children:n.jsxs(E,{style:{fontSize:"24px",fontWeight:"700",color:C,display:"flex",alignItems:"center"},children:[x==="accurate"?null:H?n.jsx(Fe,{style:{marginRight:"8px",fontSize:"22px"}}):n.jsx(Me,{style:{marginRight:"8px",fontSize:"22px"}}),x==="accurate"?"±":H?"+":"-",R,"kcal"]})})]})});try{q.alert({title:`${u?"🔔 ":""}${h==="dinner"?"어제":"지난"} ${h==="breakfast"?"아침":h==="lunch"?"점심":"저녁"} 식사 결과`,content:L,confirmText:"확인했습니다.",onConfirm:()=>{f(h)}})}catch(d){console.error("모달 표시 중 오류 발생:",d),alert("식사 결과를 확인할 수 없습니다. 오류가 발생했습니다.")}},[t,m,e,f]),w=r.useCallback(()=>{if(t||!e)return{available:!1,mealType:null};const u=new Date().getHours();let l=null;if(u>=6&&u<=10?l="dinner":u>=11&&u<=14?l="breakfast":u>=17&&u<=20&&(l="lunch"),l){const y=e[l],g=y&&y.originalCalories?.actual!==void 0&&y.originalCalories?.actual!==null&&y.originalCalories?.estimated!==void 0&&y.originalCalories?.estimated!==null,x=!a[l];if(g&&x)return{available:!0,mealType:l}}const b=["breakfast","lunch","dinner"];for(const y of b){const g=e[y],x=g&&g.originalCalories?.actual!==void 0&&g.originalCalories?.actual!==null&&g.originalCalories?.estimated!==void 0&&g.originalCalories?.estimated!==null,k=!a[y];let v=!1;if((y==="breakfast"&&u>=11||y==="lunch"&&u>=17||y==="dinner"&&u>=6)&&(v=!0),x&&k&&v)return{available:!0,mealType:y}}return{available:!1,mealType:null}},[e,a,t]),j=r.useCallback(()=>{if(t)return{available:!0,mealType:"lunch"};const u=new Date().getHours();let l=null;return u>=6&&u<=10?l="dinner":u>=11&&u<=14?l="breakfast":u>=17&&u<=20&&(l="lunch"),{available:l&&e?.[l]&&e[l].originalCalories?.actual!==void 0&&e[l].originalCalories?.estimated!==void 0,mealType:l,isValidTime:l!==null}},[e,t]),T=r.useCallback(()=>{const h=j(),{available:u,mealType:l,isValidTime:b}=h;if(t){c(l);return}if(u&&l)c(l);else{const g=new Date().getHours();let x="";if(!b)x=n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx(E,{style:{fontSize:16,lineHeight:1.5},children:"현재는 이전 식사 결과를 조회할 수 있는 시간이 아닙니다."}),n.jsx("br",{}),n.jsx("br",{}),n.jsx(E,{strong:!0,style:{fontSize:15,color:"#333",lineHeight:1.5,marginTop:"10px"},children:"조회 가능 시간:"}),n.jsx("br",{}),n.jsxs(E,{style:{fontSize:14,color:"#666",lineHeight:1.8},children:["- 아침 식사 결과: 오전 11시 ~ 오후 2시",n.jsx("br",{}),"- 점심 식사 결과: 오후 5시 ~ 오후 8시",n.jsx("br",{}),"- 저녁 식사 결과: 오전 6시 ~ 오전 10시"]})]});else{const k={fontSize:16,textAlign:"center",lineHeight:1.5};g>=6&&g<=10?x=n.jsx(E,{style:k,children:"어제 저녁 식사 기록이 없습니다."}):g>=11&&g<=14?x=n.jsx(E,{style:k,children:"아침 식사 기록이 없습니다."}):g>=17&&g<=20&&(x=n.jsx(E,{style:k,children:"점심 식사 기록이 없습니다."}))}q.alert({title:"식사 결과 조회 불가",content:x,confirmText:"확인"})}},[j,c,t]),F=r.useCallback(()=>{const h=w();h.available&&h.mealType&&c(h.mealType,!0)},[w,c]);return{showModal:T,showAutoModal:F,isModalAvailable:j().available,isAutoModalAvailable:w().available,calculateCalorieDifference:m,getOriginalCalorieDifference:S,getMealOffset:s,getMealAppliedDeviation:o}},{Text:z,Title:Ze}=ee,hn=()=>{const e=me(),t=_(d=>d.auth.user?.uid),a=_(d=>d.meal.mealFlags),{foodData:i,loading:f,error:m}=Ce(),{surveyState:S,checkGlobalSurveyStatus:o,checkUserSurveyCompletion:s}=xe(),[c,w]=r.useState({breakfast:!1,lunch:!1,dinner:!1,snack:!1}),[j,T]=r.useState(""),[F,h]=r.useState(!1),[u,l]=r.useState(!1),b=pe(),{showModal:y,showAutoModal:g,isModalAvailable:x,isAutoModalAvailable:k}=Ye(i);r.useEffect(()=>{if(i&&k){const d=setTimeout(()=>{g()},1e3);return()=>clearTimeout(d)}},[i,k,g]),r.useEffect(()=>{const d=async()=>{if(t)try{const p=await o();if(p&&p.isActive){const ae=!await s(t,p.surveyId);l(ae)}else l(!1)}catch(p){console.error("설문조사 상태 확인 실패:",p),l(!1)}};d();const $=setInterval(d,5*60*1e3);return()=>clearInterval($)},[t,o,s]),r.useEffect(()=>{(async()=>{if(t)try{const $=await Se(t);e(U($))}catch($){console.error("Meal flags 로드 실패:",$)}})()},[t,e]),r.useEffect(()=>{if(i){const d={breakfast:i.breakfast?.flag!==void 0?i.breakfast.flag:a.breakfast||0,lunch:i.lunch?.flag!==void 0?i.lunch.flag:a.lunch||0,dinner:i.dinner?.flag!==void 0?i.dinner.flag:a.dinner||0,snack:0};Object.keys(d).some(p=>d[p]!==a[p])&&e(U(d))}},[i,e]),r.useEffect(()=>{const d=()=>{const p=new Date().getHours();p>=6&&p<12?T("아침"):p>=12&&p<18?T("점심"):p>=18?T("저녁"):T("새벽"),w({breakfast:p<6||p>=12,lunch:p<12||p>=18,dinner:p<18||p>=24,snack:!1})};d();const $=setInterval(d,6e4);return()=>clearInterval($)},[]);const v=({isFasting:d,onChange:$,disabled:p})=>n.jsxs("div",{className:`w-full rounded-xl p-4 ${p?"opacity-60":""}`,style:{height:"91px",fontFamily:"Pretendard-600",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:d?"#fff2f0":"white",borderColor:d?"#ff7875":"#e8e8e8",borderWidth:d?"2px":"1px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"8px"},children:[n.jsx(z,{style:{fontSize:"17px",fontFamily:"Pretendard-500",color:d?"#ff7875":"#999",margin:0,marginBottom:"2px"},children:"단식"}),n.jsx(te,{checked:d,onChange:$,disabled:p,style:{backgroundColor:d?"#ff7875":void 0}})]});if(f)return n.jsx("div",{className:"h-[100%] flex justify-center items-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500 mx-auto mb-4"}),n.jsx(z,{style:{color:"#666",fontFamily:"Pretendard-500"},children:"데이터를 불러오는 중입니다..."})]})});if(m)return n.jsx("div",{className:"h-[100%] flex justify-center items-center",children:n.jsxs("div",{className:"text-center p-6 bg-red-50 rounded-lg",children:[n.jsx(z,{style:{color:"red",fontFamily:"Pretendard-600",fontSize:"18px"},children:"오류가 발생했습니다"}),n.jsx(z,{style:{color:"#666",fontFamily:"Pretendard-500",display:"block",marginTop:"8px"},children:m.message})]})});const I=d=>{b(`/meals/${d}`)},C=async(d,$)=>{const p=$?2:0;e(G(d,p));try{await we(t,d,p)}catch(B){console.error("단식 상태 저장 실패:",B),e(G(d,$?0:2))}},M=d=>{switch(d){case"breakfast":return"06시부터 11시59분까지만 기록 가능";case"lunch":return"12시부터 17시59분까지만 기록 가능";case"dinner":return"18시부터 23시59분까지만 기록 가능";default:return""}},R=new Date,H=R.toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\.$/,""),L=R.toLocaleDateString("ko-KR",{weekday:"long"});return n.jsxs("div",{className:"h-[100%] bg-bg1 p-4 pb-16 overflow-auto",children:[n.jsx(J,{bordered:!1,style:{borderRadius:"16px",marginBottom:"16px",boxShadow:"0 4px 12px rgba(0,0,0,0.05)"},children:n.jsxs(P,{justify:"space-between",align:"middle",children:[n.jsxs("div",{children:[n.jsxs(z,{style:{fontSize:"20px",fontWeight:"700",fontFamily:"Pretendard-700"},children:[H," ",L]}),n.jsx("br",{}),n.jsxs(z,{style:{fontSize:"16px",color:"#666",fontFamily:"Pretendard-500"},children:["현재 시간대: ",j]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[u&&n.jsx("div",{onClick:()=>h(!0),style:{cursor:"pointer",padding:"8px",background:"#f0f9ff",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"},children:n.jsx(Q,{style:{fontSize:"24px",color:"#1890ff"}})}),n.jsxs("div",{onClick:y,style:{position:"relative",cursor:"pointer",padding:"8px",background:x?"#f0fff7":"#f5f5f5",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center"},children:[n.jsx(Ve,{style:{fontSize:"24px",color:x?"#5FDD9D":"#999"}}),x&&n.jsx("div",{style:{position:"absolute",top:"0",right:"0",width:"10px",height:"10px",backgroundColor:"#ff4d4f",borderRadius:"50%"}})]})]})]})}),u&&n.jsx(J,{bordered:!1,style:{borderRadius:"16px",marginBottom:"16px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},onClick:()=>h(!0),className:"cursor-pointer hover:shadow-lg transition-all duration-300",children:n.jsxs(P,{justify:"space-between",align:"middle",children:[n.jsxs("div",{style:{color:"white"},children:[n.jsx(z,{style:{fontSize:"18px",fontWeight:"700",color:"white",fontFamily:"Pretendard-700"},children:"📋 설문조사 참여 요청"}),n.jsx("br",{}),n.jsx(z,{style:{fontSize:"14px",color:"rgba(255,255,255,0.9)",fontFamily:"Pretendard-500"},children:"점심 식사 관련 설문조사에 참여해주세요!"})]}),n.jsx("div",{style:{background:"rgba(255,255,255,0.2)",borderRadius:"50%",padding:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx(Q,{style:{fontSize:"24px",color:"white"}})})]})}),n.jsx(Ze,{level:4,style:{margin:"24px 0 16px 0",fontFamily:"Pretendard-700",color:"#5FDD9D"},children:"일일 식사 기록"}),n.jsxs(P,{gutter:[16,16],justify:"center",children:[n.jsx(D,{span:24,children:n.jsxs(P,{gutter:[12,0],align:"middle",children:[n.jsx(D,{span:18,children:n.jsx(V,{title:"아침 식사 기록",icon:n.jsx(W,{}),time:"06:00 - 11:59",onClick:()=>I("breakfast"),disabled:a.breakfast===1||a.breakfast===2||c.breakfast,isCompleted:a.breakfast===1,isFasting:a.breakfast===2,timeRestricted:a.breakfast===0&&c.breakfast,restrictionMessage:M("breakfast")})}),n.jsx(D,{span:6,children:n.jsx(v,{isFasting:a.breakfast===2,onChange:d=>C("breakfast",d),disabled:a.breakfast===1})})]})}),n.jsx(D,{span:24,children:n.jsxs(P,{gutter:[12,0],align:"middle",children:[n.jsx(D,{span:18,children:n.jsx(V,{title:"점심 식사 기록",icon:n.jsx(W,{}),time:"12:00 - 17:59",onClick:()=>I("lunch"),disabled:a.lunch===1||a.lunch===2||c.lunch,isCompleted:a.lunch===1,isFasting:a.lunch===2,timeRestricted:a.lunch===0&&c.lunch,restrictionMessage:M("lunch")})}),n.jsx(D,{span:6,children:n.jsx(v,{isFasting:a.lunch===2,onChange:d=>C("lunch",d),disabled:a.lunch===1})})]})}),n.jsx(D,{span:24,children:n.jsxs(P,{gutter:[12,0],align:"middle",children:[n.jsx(D,{span:18,children:n.jsx(V,{title:"저녁 식사 기록",icon:n.jsx(W,{}),time:"18:00 - 05:59",onClick:()=>I("dinner"),disabled:a.dinner===1||a.dinner===2||c.dinner,isCompleted:a.dinner===1,isFasting:a.dinner===2,timeRestricted:a.dinner===0&&c.dinner,restrictionMessage:M("dinner")})}),n.jsx(D,{span:6,children:n.jsx(v,{isFasting:a.dinner===2,onChange:d=>C("dinner",d),disabled:a.dinner===1})})]})}),n.jsx(D,{span:24,children:n.jsx(V,{title:"간식 기록",icon:n.jsx(ye,{}),time:"언제든지 기록 가능",onClick:()=>I("snack"),disabled:!1,isCompleted:!1,isFasting:!1,timeRestricted:!1,accent:!1})})]}),n.jsx(be,{visible:F,onClose:()=>h(!1),uid:t})]})},V=({title:e,icon:t,time:a,onClick:i,disabled:f,isCompleted:m,isFasting:S=!1,timeRestricted:o,restrictionMessage:s,accent:c=!1})=>n.jsxs(je,{onClick:i,disabled:f,className:`w-full rounded-xl p-0 relative ${f?"opacity-60":""}`,style:{height:"91px",textAlign:"left",fontFamily:"Pretendard-600",boxShadow:"0 2px 6px rgba(0,0,0,0.08)",background:c?"#f0fff7":"white",borderColor:c?"#5FDD9D":"#e8e8e8",padding:"16px",overflow:"hidden"},children:[S?n.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:n.jsx(z,{style:{fontSize:"20px",fontWeight:"600",fontFamily:"Pretendard-600",color:"#ff7875",textAlign:"center"},children:e.includes("아침")?"아침 단식":e.includes("점심")?"점심 단식":e.includes("저녁")?"저녁 단식":"단식 중"})}):n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsxs("div",{style:{flex:1},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px",color:m?"#5FDD9D":"#333"},children:[t,n.jsx(z,{style:{marginLeft:"8px",fontSize:"18px",fontWeight:"600",fontFamily:"Pretendard-600",color:m?"#5FDD9D":"#333"},children:e})]}),n.jsx(z,{style:{fontSize:"14px",color:"#888",fontFamily:"Pretendard-500"},children:a})]}),n.jsx("div",{style:{display:"flex",alignItems:"center"},children:m&&n.jsx(Ee,{twoToneColor:"#5FDD9D",style:{fontSize:24}})})]}),o&&n.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(255,255,255,0.9)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",borderRadius:"12px"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"12px"},children:[n.jsx(z,{style:{fontSize:"16px",color:"#ff4d4f",fontFamily:"Pretendard-500",textAlign:"center",marginBottom:"6.5px",marginRight:"8px"},children:"식사 미기록"}),n.jsx(ve,{style:{fontSize:24,color:"#ff4d4f",marginBottom:"8px"}})]}),n.jsx(z,{style:{fontSize:"14px",color:"#ff4d4f",fontFamily:"Pretendard-500",textAlign:"center"},children:s})]})]});export{hn as default};
